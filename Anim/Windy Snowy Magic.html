<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Snowy Magic — Ready-to-use</title>
  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0f2233;
      --accent1:#8bf6ff;
      --accent2:#bdb4ff;
      --soft:#ffffff;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, Roboto, 'Helvetica Neue', Arial;}
    body{
      background: radial-gradient(circle at 10% 10%, rgba(139,246,255,0.06) 0%, transparent 10%),
                  linear-gradient(180deg,var(--bg1) 0%, var(--bg2) 100%);
      overflow:hidden;
      color:var(--soft);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* container */
    .wrap{
      position:relative;
      width:100vw;height:100vh;
      display:flex;align-items:center;justify-content:center;
      pointer-events:none; /* clicking passes through unless interactive elements added */
    }

    /* UI card centered for demo */
    .card{
      position:relative;z-index:30;pointer-events:auto;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border-radius:16px;padding:24px 28px;width: min(880px, 92vw);
      box-shadow: 0 8px 40px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
      backdrop-filter: blur(6px) saturate(120%);
    }
    h1{margin:0 0 8px 0;font-weight:600;font-size: clamp(18px, 3.6vw, 32px);letter-spacing: -0.5px}
    p.lead{margin:0;color:rgba(255,255,255,0.8);font-size:14px}

    /* controls (optional) */
    .controls{margin-top:14px;display:flex;gap:8px;align-items:center}
    .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));padding:8px 12px;border-radius:10px;border:0;color:#022;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--soft)}

    /* small credits */
    .credit{position:fixed;right:12px;bottom:12px;z-index:40;color:rgba(255,255,255,0.6);font-size:12px}

    /* decorative elements */
    canvas#mainCanvas{position:fixed;left:0;top:0;width:100%;height:100%;z-index:10;display:block}
    canvas#stars{position:fixed;left:0;top:0;width:100%;height:100%;z-index:5}
    .overlay-glow{position:fixed;inset:0;z-index:20;pointer-events:none;background:radial-gradient(60% 40% at 20% 20%, rgba(139,246,255,0.04), transparent 8%), radial-gradient(40% 30% at 80% 80%, rgba(189,180,255,0.03), transparent 12%)}

    /* responsive tweaks */
    @media (max-width:540px){
      .card{padding:18px;border-radius:12px}
      .controls{flex-wrap:wrap}
    }
  </style>
</head>
<body>
  <canvas id="stars"></canvas>
  <canvas id="mainCanvas"></canvas>

  <div class="wrap">
    <div class="card" role="region" aria-label="Snowy magic demo card">
      <h1>Snowy Magic — Live Animation</h1>
      <p class="lead">A ready-to-use single HTML file showcasing an atmospheric snowy magic scene. Move the mouse to influence the wind, click to trigger a soft snow flare.</p>
      <div class="controls">
        <button class="btn" id="toggleWind">Pause Wind</button>
        <button class="btn ghost" id="reset">Reset</button>
        <div style="flex:1"></div>
        <small style="color:rgba(255,255,255,0.6)">Tip: click or tap anywhere to create a magic burst ✨</small>
      </div>
    </div>
  </div>

  <div class="overlay-glow"></div>
  <div class="credit">Snowy Magic — single-file demo</div>

  <script>
  /* Snowy Magic - Single-file animation
     - Uses two canvases: stars (background twinkles) and mainCanvas (snow, particles, aurora)
     - Interactive: mouse affects wind and creates bursts on click
     - Built for performance: requestAnimationFrame, pooled particles
  */
  (function(){
    const starsCanvas = document.getElementById('stars');
    const c = document.getElementById('mainCanvas');
    const starsCtx = starsCanvas.getContext('2d');
    const ctx = c.getContext('2d');

    let W = innerWidth, H = innerHeight;
    function resize(){
      W = innerWidth; H = innerHeight;
      [c, starsCanvas].forEach(canvas=>{
        canvas.width = Math.round(W * devicePixelRatio);
        canvas.height = Math.round(H * devicePixelRatio);
        canvas.style.width = W+'px';
        canvas.style.height = H+'px';
        const ctx = canvas.getContext('2d');
        ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0);
      });
      // redraw static starfield
      drawStars();
    }
    addEventListener('resize', resize, {passive:true});

    /* STARFIELD */
    const stars = [];
    function initStars(){
      stars.length = 0;
      const count = Math.round((W*H)/40000);
      for(let i=0;i<count;i++){
        stars.push({x: Math.random()*W, y: Math.random()*H*0.6, r: Math.random()*1.4+0.2, a: Math.random(), tw: Math.random()*0.02+0.005});
      }
    }
    function drawStars(){
      starsCtx.clearRect(0,0,W,H);
      // subtle gradient sky glow
      const g = starsCtx.createLinearGradient(0,0,0,H);
      g.addColorStop(0,'rgba(140,230,255,0.03)');
      g.addColorStop(1,'rgba(5,10,20,0.6)');
      starsCtx.fillStyle = g;
      starsCtx.fillRect(0,0,W,H);
      for(const s of stars){
        starsCtx.globalAlpha = s.a * (0.6 + 0.4*Math.sin(perf* s.tw));
        starsCtx.beginPath();
        starsCtx.arc(s.x, s.y, s.r, 0, Math.PI*2);
        starsCtx.fillStyle = 'white';
        starsCtx.fill();
      }
      starsCtx.globalAlpha = 1;
    }

    /* PARTICLE SYSTEM - SNOW */
    const snowPool = [];
    const activeSnow = [];
    const bursts = [];
    const MAX_SNOW = 600; // tweak for performance

    function spawnSnow(n){
      for(let i=0;i<n;i++){
        const p = snowPool.pop() || {
          x:0,y:0,vx:0,vy:0,size:0,alpha:1,type:'snow',life:0,maxLife:0
        };
        p.x = Math.random()*W;
        p.y = Math.random()*-H*0.2;
        p.vx = (Math.random()-0.5)*0.3;
        p.vy = 0.4 + Math.random()*1.2;
        p.size = Math.random()*3.2 + 0.6;
        p.alpha = 0.6 + Math.random()*0.4;
        p.life = 0;
        p.maxLife = Infinity;
        activeSnow.push(p);
      }
    }

    function recycleSnow(i){
      const p = activeSnow[i];
      activeSnow.splice(i,1);
      snowPool.push(p);
    }

    /* AURORA / SOFT GLOW LAYERS */
    function drawAurora(time){
      // moving soft bands
      const bands = 3;
      for(let b=0;b<bands;b++){
        const y = H*0.15 + b*H*0.18 + Math.sin(time*0.0006 + b*1.2)*H*0.02;
        const height = H*0.18;
        const grad = ctx.createLinearGradient(0,y,0,y+height);
        grad.addColorStop(0,'rgba(139,246,255,'+ (0.02 + b*0.01) +')');
        grad.addColorStop(0.5,'rgba(189,180,255,'+ (0.02 + b*0.015) +')');
        grad.addColorStop(1,'rgba(10,14,20,0)');
        ctx.fillStyle = grad;
        ctx.beginPath();
        // wavy shape
        ctx.moveTo(0,y);
        for(let x=0;x<=W;x+=30){
          const t = (x/W)*Math.PI*2;
          ctx.lineTo(x, y + Math.sin(t* (0.7 + b*0.2) + time*0.0012 + b)*30);
        }
        ctx.lineTo(W,y+height);
        ctx.lineTo(0,y+height);
        ctx.closePath();
        ctx.fill();
      }
    }

    /* MAGIC BURST */
    function createBurst(x,y){
      const count = 18 + Math.round(Math.random()*18);
      for(let i=0;i<count;i++){
        bursts.push({x,y, vx:(Math.random()-0.5)*6, vy:(Math.random()-0.9)*6, size:Math.random()*3+1, life:0, maxLife:400 + Math.random()*300, color: (Math.random()>0.5? 'rgba(139,246,255,':'rgba(189,180,255,') });
      }
    }

    /* wind & interactivity */
    let wind = 0.02; // base
    let windPaused = false;
    let mx = W/2, my = H/2;
    let isPointerDown = false;
    let perf = 0;

    addEventListener('pointermove', e=>{
      mx = e.clientX; my = e.clientY;
      // small wind influence based on pointer position
      wind = ((mx - W*0.5) / W) * 0.6;
    }, {passive:true});

    addEventListener('pointerdown', e=>{
      isPointerDown = true;
      createBurst(e.clientX, e.clientY);
    });
    addEventListener('pointerup', ()=> isPointerDown = false);

    document.getElementById('toggleWind').addEventListener('click', function(){
      windPaused = !windPaused;
      this.textContent = windPaused ? 'Resume Wind' : 'Pause Wind';
    });
    document.getElementById('reset').addEventListener('click', ()=>{
      activeSnow.length = 0; snowPool.length = 0; bursts.length = 0; initParticles();
    });

    /* particles init */
    function initParticles(){
      initStars();
      spawnSnow(150);
      // prefill pool
      for(let i=0;i<MAX_SNOW;i++) snowPool.push({x:0,y:0,vx:0,vy:0,size:0,alpha:1,type:'snow',life:0});
    }

    /* animation loop */
    let last = performance.now();
    function loop(now){
      const dt = Math.min(40, now - last);
      last = now;
      perf = now * 0.001;
      // occasionally spawn snow to maintain density
      if(activeSnow.length < 380) spawnSnow(4);

      // clear canvas
      ctx.clearRect(0,0,W,H);

      // aurora
      drawAurora(now);

      // snow layer (depth parallax)
      // two passes: distant small snow, foreground large
      const baseWind = windPaused ? 0 : wind * 0.6;

      // update snow particles
      for(let i=activeSnow.length-1;i>=0;i--){
        const p = activeSnow[i];
        // subtle sway
        p.vx += Math.sin((p.y + perf*40) * 0.02) * 0.002;
        p.vx += baseWind * (0.6 + p.size*0.06);
        p.x += p.vx * (dt*0.06);
        p.y += p.vy * (dt*0.06);

        // twinkle / blur effect based on size
        ctx.globalAlpha = Math.max(0, Math.min(1, p.alpha * (0.9 + 0.1*Math.sin((p.x+p.y)*0.01 + perf)))) ;
        ctx.beginPath();
        // draw as soft circle with radial gradient
        const g = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.size*3+4);
        g.addColorStop(0, 'rgba(255,255,255,' + (0.6*ctx.globalAlpha) + ')');
        g.addColorStop(0.6, 'rgba(255,255,255,' + (0.12*ctx.globalAlpha) + ')');
        g.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = g;
        ctx.fillRect(p.x - p.size*3 - 4, p.y - p.size*3 - 4, p.size*6+8, p.size*6+8);

        // recycle off-screen
        if(p.y > H + 40 || p.x < -60 || p.x > W + 60){
          // respawn at top
          p.x = Math.random()*W;
          p.y = Math.random()*-80;
          p.vx = (Math.random()-0.5)*0.3;
          p.vy = 0.4 + Math.random()*1.2;
        }
      }

      // bursts
      for(let i=bursts.length-1;i>=0;i--){
        const b = bursts[i];
        b.vy += 0.02 * (dt*0.06); // gravity
        b.x += b.vx * (dt*0.06);
        b.y += b.vy * (dt*0.06);
        b.life += dt;
        const t = 1 - b.life / b.maxLife;
        if(t <= 0){ bursts.splice(i,1); continue; }
        ctx.globalAlpha = Math.max(0, t);
        // colorful sparkle
        const g = ctx.createRadialGradient(b.x, b.y, 0, b.x, b.y, b.size*12);
        g.addColorStop(0, b.color + (0.9 * t) + ')');
        g.addColorStop(0.5, 'rgba(255,255,255,' + (0.35*t) + ')');
        g.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = g;
        ctx.fillRect(b.x - b.size*12, b.y - b.size*12, b.size*24, b.size*24);

        // little star points
        if(Math.random() < 0.4){
          ctx.globalAlpha = Math.min(1,t);
          ctx.fillStyle = 'white';
          ctx.fillRect(b.x-0.5, b.y-0.5, 1,1);
        }
      }

      // subtle vignette and snow shadow
      ctx.globalAlpha = 1;
      ctx.fillStyle = 'rgba(2,6,23,0.08)';
      ctx.fillRect(0,H-80,W,80);

      // decorative foreground shimmer
      ctx.globalCompositeOperation = 'lighter';
      for(let i=0;i<4;i++){
        const sx = (perf*40 + i*200) % (W+200) - 100;
        const sy = H*0.25 + Math.sin(perf*0.6 + i)*30;
        const grd = ctx.createRadialGradient(sx, sy, 10, sx, sy, 200);
        grd.addColorStop(0,'rgba(189,180,255,0.02)');
        grd.addColorStop(1,'rgba(189,180,255,0)');
        ctx.fillStyle = grd;
        ctx.fillRect(sx-220, sy-220, 440, 440);
      }
      ctx.globalCompositeOperation = 'source-over';

      // slight noise overlay (soft)
      ctx.globalAlpha = 0.03;
      ctx.fillStyle = '#ffffff';
      for(let i=0;i<2;i++){
        const nx = Math.random()*W, ny = Math.random()*H;
        ctx.fillRect(nx,ny,1,1);
      }
      ctx.globalAlpha = 1;

      // soften edges
      // (not heavy; kept light for perf)

      requestAnimationFrame(loop);
    }

    // low-cost star twinkle update loop
    let starTick = 0;
    function starLoop(t){
      starTick += 0.01;
      for(const s of stars){
        s.a = 0.5 + 0.5*Math.sin(starTick * (s.tw*60 + 1) + s.x*0.001);
      }
      drawStars();
      requestAnimationFrame(starLoop);
    }

    // initialize
    resize();
    initParticles();
    requestAnimationFrame(loop);
    requestAnimationFrame(starLoop);

    // small UX: clicking touchscreen creates burst
    addEventListener('click', (e)=>{ createBurst(e.clientX, e.clientY); });

    // expose for debugging in console (optional)
    window.snowyMagic = { activeSnow, bursts, spawnSnow, createBurst };

  })();
  </script>
</body>
</html>
